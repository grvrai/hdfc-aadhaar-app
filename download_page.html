<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aadhaar Seva Kendra - App download</title>
    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,700" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Raleway:300,400,700" rel="stylesheet">
  
    <!-- Font Awesome Icons -->
      <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css">
  
    <!-- Bootstrap for dialogs... etc. -->
      <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
      
    <link rel="stylesheet" href="https://s3-us-west-2.amazonaws.com/engagementservices-us-west-2/Resources/Default/pa-theme.css" />
    <style>
        body {
            background: #fff;
            
        }
        .main-wrapper {
            min-height: calc(100vh - 40px);
        }
        .app-color {
            color:#3f51b5;
        }
        .app-bg {
            background: #3f51b5;
        }
        .main-wrap {
            height: 100%;
        }
        header {
            padding: 0.75rem;
            background-color: white;
            box-shadow: 1px 1px 1px rgba(0, 0, 0, 0.25);
            margin-bottom: 1rem;
            min-height: 56px;
        }
        .box-wrap {
            /*height:calc(100vh - 85px);*/
        }
        .main-heading {
            font-size: 5vw;
            color: #fff;
            font-weight: 800;
            font-family: 'Raleway', sans-serif;
        }
        .sub-title {
            text-transform: uppercase;
            font-family: 'Roboto', sans-serif;
            font-weight: 800;
        }
        .acc-list li {
            margin-bottom:10px;
        }
        .rotate {
            transform:rotateX(180deg);
            transition-duration: 0.2s;
        }
        .aadhar-logo {
            background:#fff;
            padding:10px;
        }
        .acc-list {
            font-size: 14px;
        }
        .acc-list li {
            position: relative;
            padding-left: 20px;
        }
        .acc-list li::before {
            content: '\f058';
            position: absolute;
            color: #3f51b5;
            font-family: 'Font Awesome 5 Free';
            left: 0;
        }
        .acc-head:hover {
            background: #f1f1f1 !important;
        }
        .install-btn:hover {
            background: #f1f1f1;
            color:#000 !important;
        }
    </style>

</head>

<body>
    <div class="main-wrapper">
        <div class="box-wrap container">
            <div class="row py-3">
                <div class="col-5">
                    <div class="text-center">
                        <img alt="aadhar-logo" src="https://s3-us-west-2.amazonaws.com/engagementservices-us-west-2/Resources/Default/ASK-Color-192.png" class="shadow-sm rounded p-2" style="height:90px">
                        <a href="{{landing_page.metadata.download_url}}" class="btn btn-light app-bg text-white mt-4 install-btn"><i class="fab fa-android mr-2"></i>Install</a>
                    </div>
                </div>
                <div class="col-7">
                    <h1 class="lead mb-2">Aadhaar Seva Kendra</h1>
                    <small class="text-muted d-block">Report on Aadhaar information updates of citizens done at bank branch offices and Aadhaar Seva Kendra’s</small>
                    {% comment %} <small class="text-muted"><strong>Download Apk Now!</strong></small> {% endcomment %}
                </div>
            </div>
        </div>
        <div class="w-100 mt-4">
            <div class="acc-head border p-3 d-flex align-items-center bg-white shadow-sm">
                <p class="mb-0">If the App install does not start automatically!</p>
                <i class="fas fa-chevron-down ml-auto rotate"></i>
            </div>
            <div class="acc-content border border-top-0 p-3 bg-white">
                <ul class="acc-list">
                    <li>Go to your <strong>Downloads</strong>.</li>
                    <li>Find Apk <strong>(ASK.apk)</strong> file.</li>
                    <li>Tap to <strong>Install</strong>.</li>
                </ul>
            </div>
        </div>
        <div class="w-100 mt-0">
            <div class="acc-wrap w-100">
                <div class="acc-head border p-3 d-flex align-items-center bg-white shadow-sm">
                    <p class="mb-0">How to Install from unknown sources?</p>
                    <i class="fas fa-chevron-down ml-auto"></i>
                </div>
                <div class="acc-content border border-top-0 p-3 bg-white" style="display:none;">
                    <ul class="acc-list">
                        <li>Open “Settings“.</li>
                        <li>Select “Menu”  at the upper-right corner, then choose “Special access“.</li>
                        <li>Select “Install unknown apps“.</li>
                        <li>Choose the application you are installing the APK file from. For example, if you are downloading the APK file in Chrome on your Android device, then attempting to open it, select “Chrome“. If you are simply browsing to the file using a File manager like “My Files“, select “My Files“.</li>
                        <li>Toggle the “Allow from this source” option to “On“.</li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="w-100 mt-0">
            <div class="acc-head border p-3 d-flex align-items-center bg-white shadow-sm" id="contact-btn">
                <p class="mb-0">Having Issues? Contact Us</p>
                <i class="fas fa-chevron-down ml-auto"></i>
            </div>
            <div class="acc-content border border-top-0 p-3 bg-white" style="display:none;" id="contact_from">
                <div class="col-12 p-0">
                    <form class="pure-form rounded">
                        <p class="mb-0 d-none">Contact us <small><i class="fas fa-times float-right d-none" id="close-form"></i></small></p>
                        <small class="text-muted mb-3 d-block">Please fill out the form below to get assistance on any issues</small>
                        <div class="form-group">
                            <label><small>Name</small></label>
                            <input type="text" id="inp-name" class="form-control" data-field="name">
                        </div>
                        <div class="form-group">
                            <label><small>Phone</small></label>
                            <input type="number" id="inp-email" class="form-control" data-field="phone">
                        </div>
                        <div class="form-group">
                            <label><small>Message</small></label>
                            <textarea id="inp-msg" rows="3" class="form-control" data-field="message"></textarea>
                        </div>
                        <div class="form-group">
                            <div class="text-success mb-2" role="alert" id="msg" style="display:none"></div>
                            <button type="submit" class="btn btn-success btn-sm btn-submit"><span id="btn-loader" style="display: none;"> <i class="fas fa-spinner fa-spin"></i></span> <span id="btn-text"><i class="fas fa-paper-plane mr-2"></i>Submit</span></button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
        <div class="app-bg pt-4">
            <div class="w-100 text-center px-3">
                <img src="https://s3-us-west-2.amazonaws.com/engagementservices-us-west-2/Resources/Default/app-download-banner.png" class="mw-100">
            </div>
        </div>
    </div>    
    <div class="bg-dark text-center py-2 text-white">
        <small>Powered by</small> <img src="https://s3-us-west-2.amazonaws.com/engagementservices-us-west-2/Resources/Default/logo_text.png" alt="logo" style="height:20px;">
    </div>
</body>
<script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
<script>
    function fetchData(type, url, data, apikey = null) {

        var init = {
            // must match 'Content-Type' header
            cache: 'no-cache', // *default, no-cache, reload, force-cache, only-if-cached
            credentials: 'same-origin', // include, same-origin, *omit
            headers: {
                "Accept": 'application/json',
                "Content-Type": 'application/json'
            },
            method: type
            // *GET, POST, PUT, DELETE, etc.
            // mode: 'cors', // no-cors, cors, *same-origin
            // redirect: 'follow', // manual, *follow, error
            // referrer: 'no-referrer', // *client, no-referrer
        }
        if (apikey) init.headers["Authorization"] = apikey;


        if (type == 'GET' && data) {
            //init.body = '';
            url += jsonToQueryString(data);
        } else if (data) {
            init.body = JSON.stringify(data);
        }

        var response = null;


        // Default options are marked with *
        return fetch(url, init)
            .then(responseObject => {
                // Saving response for later use in lower scopes
                response = responseObject;

                console.log(responseObject.body)

                // HTTP unauthorized
                if (response.status === 401) {

                }

                // Check for error HTTP error codes
                if (response.status < 200 || response.status >= 300 || response.status == 204 || response.status == 202) {
                    // Get response as text
                    return response.text();
                }

                // Get response as json if present (may not be an API.  This is used for a page refresh too).
                try {
                    responsejson = response.json();
                } catch (e) {
                    responsejson = {};
                }
                return responsejson;
            })

            // "parsedResponse" will be either text or javascript object depending if
            // "response.text()" or "response.json()" got called in the upper scope
            .then(parsedResponse => {
                // Check for HTTP error codes
                if (response.status < 200 || response.status >= 300) {
                    // Throw error
                    throw parsedResponse;
                }

                // Request succeeded
                return parsedResponse;
            })
            .catch(error_data => {
                // Throw custom API error
                // If response exists it means HTTP error occured
                if (response) {
                    if (response.status > 300) {
                        var error = new Error(`Request failed with status ${ response.status }.`);
                        try {
                            error.response = JSON.parse(error_data);
                        } catch (e) {
                            error.response = "";
                        }
                        error.status = response.status;
                        throw error;
                        //throw new Error(`Request failed with status ${ response.status }.`, error, response.status);
                    }
                } else {
                    //throw new ApiError(error.toString(), null, 'REQUEST_FAILED');
                    var error = new Error(error_data.toString());
                    //error.response = response.json();
                    throw error;
                }
            });

    }

    function main() {
        $('.acc-head').on('click', function () {
            $(this).next('.acc-content').slideToggle(200);
            $(this).find('i').toggleClass('rotate');
        });
        // $('#contact-btn').on('click', function () {
        //     ContactForm.show();
        // })
    }
    var ContactForm = function () {
        var parent = $('#contact_from');
        var isInit = null;
        function init() {
            if (isInit) return;
            initListners();
            isInit = true;
        }

        function initListners() {
            parent.find('form').on('submit', function (e) {
                e.preventDefault();
                submit();
            });
            parent.find('#close-form').on('click', function () {
                hide();
            });
        }
        
        function hide() {
            clear();
            parent.slideUp(200);
        }

        function submit() {
            var msg = parent.find('#msg');
            showLoadingState(true);
            var api = `{{domain}}/api/email/`;
            let payload = getPayload();
            if (!payload) return;
            fetchData('POST', api, payload).then(function(data) {
                msg.removeClass('text-danger').addClass('text-success');
                msg.html('<i class="fas fa-check mr-2"></i>Your request has been submitted successfully!');
                msg.show();
                showLoadingState(false);
                setTimeout(()=> {
                msg.hide();
                hide();
                }, 2000)
            }).catch(function(err) {
                msg.removeClass('text-success').addClass('text-danger');
                msg.text('<i class="fas fa-times mr-2"></i>Unable to submit Form please check fields below');
                setTimeout(() => {
                msg.hide();
                hide();
                }, 2000);
                showLoadingState(false);
            })
        }

        function getPayload() {
            var payload = {};
            parent.find('input, textarea').each(function (item) {
                let inp = $(this);
                let field = $(this).attr('data-field');
                payload[field] = inp.val();
            })
            return {
                tolist: ["support@peakengage.com"],
                subj: "Aadhaar App Download Page Issue",
                body: "Name:" + payload.name + "\n\nPhone:" + payload.phone + "\n\nComments :" + payload.message + ""
            }
        }
        function showLoadingState(show=false) {
            var text = parent.find('#btn-text');
            var loader = parent.find('#btn-loader');
            if(show) {
                text.hide();
                loader.show();
            }
            else {
                loader.hide();
                text.show();
            }
        }
        function clear() {
            let form =  parent.find('form');
            form.find('input, textarea').each(function() {
                $(this).val('');
            })
        }
        init();
        return {
            //show: show,
            hide: hide,
            showLoadingState:showLoadingState
        }

    }();
    $(document).ready(main);
</script>
</html>